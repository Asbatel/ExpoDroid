package malware.scanner.Tasks;

import org.json.JSONException;
import org.json.JSONObject;
import java.util.ArrayList;

import malware.scanner.Utils.ScansOperators;

public class GetMalwareDetails {

    private  String scansArray[], operatorsArray[];
    private ArrayList<String> resultArray;
    JSONObject object;


    public ArrayList<String> ParseDetails(String unparsedJson) throws JSONException {
        object = new JSONObject(unparsedJson);
        int length = Integer.parseInt(object.getString("total"));
        scansArray = new String[length];
        operatorsArray = new String[length];
        resultArray = new ArrayList<String>();
        JSONObject scans= object.getJSONObject("scans");

        for (int i = 0, j = 0; i<length && j<ScansOperators.services.length; i++, j++) {

            if(scans.has(ScansOperators.services[i])) {
                scansArray[i] =  scans.getString(ScansOperators.services[i]);
                operatorsArray[i] = ScansOperators.services[i];
                resultArray.add(scansArray[i].concat("-").concat(operatorsArray[i]));
            }

        }

        return resultArray;
    }
}
